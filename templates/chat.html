{% extends "base.html" %}
{% block content %}
<div class="chat-container">
    <h1>üí¨ –ß–∞—Ç –¢–∞–Ω–∫–∏—Å—Ç–æ–≤</h1>
    
    <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
    <div id="messages" class="messages-container"></div>
    
    <!-- –§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
    <form id="chatForm" onsubmit="sendMessage(event)">
        <input type="text" id="messageInput" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="500">
        <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </form>
    
    {% if current_user.role in ['Admin', 'Moderator'] %}
    <!-- –ü–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏ -->
    <div class="moderation-panel">
        <h3>–ú–æ–¥–µ—Ä–∞—Ü–∏—è</h3>
        <button onclick="showMuteModal()">–ó–∞–º—É—Ç–∏—Ç—å</button>
    </div>
    {% endif %}
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º—É—Ç–∞ -->
<div id="mute-modal" class="modal">
    <div class="modal-content">
        <h3>–ó–∞–º—É—Ç–∏—Ç—å –∏–≥—Ä–æ–∫–∞</h3>
        <p>–ò–≥—Ä–æ–∫: <span id="mute-target"></span></p>
        <input type="number" id="mute-duration" placeholder="–ú–∏–Ω—É—Ç—ã">
        <input type="text" id="mute-reason" placeholder="–ü—Ä–∏—á–∏–Ω–∞">
        <button onclick="performMute()">–ó–∞–º—É—Ç–∏—Ç—å</button>
        <button onclick="closeMuteModal()">–û—Ç–º–µ–Ω–∞</button>
    </div>
</div>

<script src="{{ url_for('static', filename='script.js') }}"></script>
<script>
function sendMessage(event) {
    event.preventDefault();
    const message = document.getElementById('messageInput').value;
    fetch('/send_message', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({message: message})
    }).then(() => {
        document.getElementById('messageInput').value = '';
        loadMessages();
    });
}
</script>
{% endblock %}